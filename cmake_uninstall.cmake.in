# CMake uninstall script for VaultArchive
#
# This script removes all installed files from the system
#

if(NOT EXISTS "@CMAKE_CURRENT_BINARY_DIR@/install_manifest.txt")
  message(FATAL_ERROR "Cannot find install manifest: @CMAKE_CURRENT_BINARY_DIR@/install_manifest.txt")
endif()

file(READ "@CMAKE_CURRENT_BINARY_DIR@/install_manifest.txt" install_manifest)
string(REGEX REPLACE "\n" ";" install_manifest_list "${install_manifest}")

foreach(file IN LISTS install_manifest_list)
  message(STATUS "Uninstalling: ${file}")
  if(EXISTS "${file}")
    exec_program("@CMAKE_COMMAND@" ARGS "-E remove \"${file}\""
                OUTPUT_VARIABLE rm_out
                RETURN_VALUE rm_retval)
    if(NOT "${rm_retval}" STREQUAL 0)
      message(FATAL_ERROR "Problem removing file: ${file}")
    endif()
  else()
    message(STATUS "File ${file} does not exist - skipping")
  endif()
endforeach(file)

message(STATUS "VaultArchive uninstallation complete")
